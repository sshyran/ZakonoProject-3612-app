"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();!function(e){var n=function(){function e(){var n=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,e),this.listSelector=n.listSelector,this.minItems=n.minItems,this.hideOnMinItemsOrLessSelector=n.hideOnMinItemsOrLessSelector,this.run()}return _createClass(e,[{key:"run",value:function(){var e=$(this.listSelector),n=e.find(this.hideOnMinItemsOrLessSelector);e.length<=this.minItems?n.hide():n.show()}}]),e}();e.DecidimAdmin=e.DecidimAdmin||{},e.DecidimAdmin.AutoButtonsByMinItemsComponent=n}(window);_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();!function(e){var n=function(){function e(){var n=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,e),this.wrapperSelector=n.wrapperSelector,this.selectSelector=n.selectSelector,this.listSelector=n.listSelector}return _createClass(e,[{key:"run",value:function(){var e=$(this.listSelector),n=e.parents(this.wrapperSelector).find(this.selectSelector);n.find("option").slice(1).remove();for(var t=2;t<=e.length;t+=1)$('<option value="'+t+'">'+t+"</option>").appendTo(n)}}]),e}();e.DecidimAdmin=e.DecidimAdmin||{},e.DecidimAdmin.AutoSelectOptionsByTotalItemsComponent=n}(window),function(e){var n=e.DecidimAdmin,t=n.AutoLabelByPositionComponent,o=n.AutoButtonsByPositionComponent,i=n.AutoButtonsByMinItemsComponent,r=n.AutoSelectOptionsByTotalItemsComponent,l=n.createFieldDependentInputs,s=n.createDynamicFields,u=n.createSortList,c=e.Decidim.createQuillEditor,d=".survey-questions",a=".survey-question",p="select[name$=\\[question_type\\]]",f=".survey-question-answer-option",m=".survey-question-answer-options",v=".remove-answer-option",h=".survey-question-max-choices",S=new t({listSelector:".survey-question:not(.hidden)",labelSelector:".card-title span:first",onPositionComputed:function(e,n){$(e).find("input[name$=\\[position\\]]").val(n)}}),w=new o({listSelector:".survey-question:not(.hidden)",hideOnFirstSelector:".move-up-question",hideOnLastSelector:".move-down-question"}),y=function(e){return new r({wrapperSelector:a,selectSelector:h+" select",listSelector:"#"+e+" "+m+" .survey-question-answer-option:not(.hidden)"})},C=function(e){return new i({wrapperSelector:a,listSelector:"#"+e+" "+m+" .survey-question-answer-option:not(.hidden)",minItems:2,hideOnMinItemsOrLessSelector:v})},q=function(){u(".survey-questions-list:not(.published)",{handle:".question-divider",placeholder:'<div style="border-style: dashed; border-color: #000"></div>',forcePlaceholderSize:!0,onSortUpdate:function(){S.run()}})},F=function(e){var n=C(e),t=y(e);return s({placeholderId:"survey-question-answer-option-id",wrapperSelector:"#"+e+" "+m,containerSelector:".survey-question-answer-options-list",fieldSelector:f,addFieldButtonSelector:".add-answer-option",removeFieldButtonSelector:v,onAddField:function(){n.run(),t.run()},onRemoveField:function(){n.run(),t.run()}})},b={},I=function(e){var n=e.val();return"single_option"===n||"multiple_option"===n||"sorting"===n},A=function(e){var n=e.attr("id"),t=e.find(p);l({controllerField:t,wrapperSelector:a,dependentFieldsSelector:m,dependentInputSelector:f+" input",enablingCondition:function(e){return I(e)}}),l({controllerField:t,wrapperSelector:a,dependentFieldsSelector:h,dependentInputSelector:"select",enablingCondition:function(e){return"multiple_option"===e.val()}}),b[n]=F(n);var o=b[n],i=function(){I(t)&&(0===t.parents(a).find(f).length&&(o._addField(),o._addField()))};t.on("change",i),i()},B=function(e){"true"===e.find("input[name$=\\[deleted\\]]").val()&&(e.addClass("hidden"),e.hide())};s({placeholderId:"survey-question-id",wrapperSelector:d,containerSelector:".survey-questions-list",fieldSelector:a,addFieldButtonSelector:".add-question",removeFieldButtonSelector:".remove-question",moveUpFieldButtonSelector:".move-up-question",moveDownFieldButtonSelector:".move-down-question",onAddField:function(e){A(e),q(),e.find(".editor-container").each(function(e,n){c(n)}),S.run(),w.run()},onRemoveField:function(e){S.run(),w.run(),e.find(v).each(function(n,t){b[e.attr("id")]._removeField(t)})},onMoveUpField:function(){S.run(),w.run()},onMoveDownField:function(){S.run(),w.run()}}),q(),$(a).each(function(e,n){var t=$(n);B(t),A(t)}),S.run(),w.run()}(window);